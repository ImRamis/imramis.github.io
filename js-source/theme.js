class ThemeManager{constructor(){this.currentTheme=localStorage.getItem("theme")||CONFIG.defaultTheme,this.customColor=localStorage.getItem("customColor")||CONFIG.defaultAccentColor,this.init()}init(){this.applyTheme(this.currentTheme),this.setupEventListeners(),"custom"===this.currentTheme&&this.applyCustomColor(this.customColor)}applyTheme(e){document.body.setAttribute("data-theme",e),this.currentTheme=e,localStorage.setItem("theme",e),this.updateParticleColor(),this.updateMatrixRain(),window.dispatchEvent(new CustomEvent("themeChanged",{detail:{theme:e}}))}applyCustomColor(e){this.customColor=e,document.documentElement.style.setProperty("--custom-color",e),localStorage.setItem("customColor",e),"custom"===this.currentTheme&&this.updateParticleColor()}updateParticleColor(){if(!window.pJSDom||!window.pJSDom[0])return;let e="#000000",t="#000000",o=.5;switch(this.currentTheme){case"monochrome":e="#ffffff",t="#ffffff",o=.3;break;case"hacker":e="#ff0000",t="#ff0000",o=.7;break;case"dark":e="#ffffff",t="#ffffff",o=.5;break;case"light":e="#0066ff",t="#0066ff",o=.9;break;case"custom":e=this.customColor,t=this.customColor,o=.5}const a=window.pJSDom[0].pJS;a.particles.color.value=e,a.particles.line_linked.color=t,a.particles.opacity.value=o,a.fn.particlesRefresh()}updateMatrixRain(){const e=document.getElementById("matrix-rain");e&&(e.innerHTML="","hacker"!==this.currentTheme&&"dark"!==this.currentTheme||this.startMatrixRain())}startMatrixRain(){const e=document.getElementById("matrix-rain");if(!e)return;const t="hacker"===this.currentTheme?"01":"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",o=()=>{const o=document.createElement("div");o.className="matrix-char",o.textContent=t[Math.floor(Math.random()*t.length)],o.style.left=100*Math.random()+"%",o.style.animationDuration=3*Math.random()+2+"s",o.style.fontSize=10*Math.random()+10+"px",o.style.animationDelay=2*Math.random()+"s",e.appendChild(o),setTimeout((()=>{o.remove()}),5e3)};for(let e=0;e<20;e++)setTimeout(o,100*e);this.matrixInterval=setInterval(o,200)}setupEventListeners(){const e=document.getElementById("theme-toggle"),t=document.getElementById("theme-dropdown");e?.addEventListener("click",(e=>{e.stopPropagation(),t.classList.toggle("show")})),document.addEventListener("click",(()=>{t?.classList.remove("show")})),document.querySelectorAll(".theme-option").forEach((e=>{e.addEventListener("click",(o=>{o.stopPropagation();const a=e.getAttribute("data-theme");this.applyTheme(a),t.classList.remove("show")}))})),document.querySelectorAll(".color-sample").forEach((e=>{e.addEventListener("click",(()=>{const t=e.getAttribute("data-color");document.getElementById("accent-color").value=t,this.applyCustomColor(t),this.applyTheme("custom")}))}));const o=document.getElementById("accent-color");o?.addEventListener("input",(e=>{this.applyCustomColor(e.target.value),this.applyTheme("custom")})),o&&(o.value=this.customColor)}destroy(){this.matrixInterval&&clearInterval(this.matrixInterval)}}let themeManager;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{themeManager=new ThemeManager})):themeManager=new ThemeManager;